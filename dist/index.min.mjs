/*! @License MIT | Copyright (c) 2022 hlop3z */
function j(i,...t){return t.forEach(e=>{for(let r in e)e[r]instanceof Object?(i[r]||Object.assign(i,{[r]:{}}),j(i[r],e[r])):Object.assign(i,{[r]:e[r]})}),i}function L(i,t,e=!1){return j(e?Object.assign({},i):i,t)}function x(i,t){if(i===t)return!0;if(typeof i!="object"||i===null||typeof t!="object"||t===null)return!1;let e=Object.keys(i),r=Object.keys(t);if(e.length!==r.length)return!1;for(let n of e)if(!r.includes(n)||!x(i[n],t[n]))return!1;return!0}function R(i,t){let e=Object.assign({},i);t(e);let r=L(i,e,!0),n=x(i,r);return{data:r,update:!n}}var P=class{constructor(t){let e={...t};this.original=e,this.current=e,this.vdom=null}get state(){return this.current}set state(t){this.update(t)}update(t){let{data:e,update:r}=R(this.current,t);r&&(this.current=e,this.vdom&&this.vdom.render())}reset(){this.current=this.original}};function z(i,t){return new P(i,t)}var $={model:z,produce:R,compare:x,merge:L};function S(i,t){if(!i)return t;if(!t)return i.remove(),null;if(i.key!==t.key||q(i,t)||i.tagName!==t.tagName)return i.replaceWith(t),t;let e=i.attributes,r=t.attributes,n=Q(e,r);for(let a=0;a<n.length;a++){let c=n[a];i.setAttribute(c.name,c.value)}return H(i,t),i}function q(i,t){return i.textContent!==t.textContent}function Q(i,t){let e=[];if(i)for(let r=0;r<t.length;r++){let n=t[r],a=i.getNamedItem(n.name);(!a||a.value!==n.value)&&e.push({name:n.name,value:n.value})}return e}function H(i,t){let e=Array.from(i.childNodes),r=Array.from(t.childNodes);for(let n=0;n<r.length||n<e.length;n++){let a=r[n],c=e[n],s=S(c,a);s&&!i.contains(s)&&i.appendChild(s)}}var I=S;var J=["click","dblclick","mousedown","mouseup","contextmenu","mouseout","mousewheel","mouseover","touchstart","touchend","touchmove","touchcancel","keydown","keyup","keypress","focus","blur","change","submit","resize","scroll","hashchange"];function B(i,t,e){let r=document.createElement(i);function n(a=null){let c={};for(let s in t){if(s==="show"&&t[s]===!1)return r.hidden=!0,r;if(s!=="key"&&s!=="show")if(s.startsWith("@")){let o=s.slice(1);J.includes(o)&&r.addEventListener(o,t[s])}else s==="class"?Array.isArray(t[s])?r.setAttribute(s,t[s].join(" ")):t[s]&&r.setAttribute(s,t[s]):r.setAttribute(s,t[s])}return Array.isArray(e)||(e=[e]),e.forEach(s=>{s&&(s instanceof d?(s.$root=r,s.$parent=a,r.appendChild(s.render())):typeof s=="object"?r.appendChild(B(...s)()):r.appendChild(document.createTextNode(s)))}),r}return n}var D=B;function X(i,t){if(typeof i=="string"){let e=document.querySelector(i),r=t.render();t.$el=r,e.appendChild(r)}else{let e=t.render();t.$el=e,i.appendChild(e)}}var d=class{constructor(t){this.$el=null,this.$root=null,this.$parent=null;let{admin:e,component:r,internalObject:n,init:a}=t;this.__dict__=e,e.vdom=this,Object.defineProperty(n,"$el",{get:()=>this.$el}),Object.defineProperty(n,"$parent",{get:()=>this.$parent}),Object.defineProperty(n,"$gui",{get:()=>window.$____XPRIVATEDICTX____$.components}),Object.defineProperty(n,"$ui",{get:()=>window.$____XPRIVATEDICTX____$}),Object.keys(r.sync).forEach(s=>{let o=r.sync[s];Object.defineProperty(n,s,{get:()=>this.$parent.data[o],set:h=>{this.$parent.data=l=>{l[o]=h}}})}),n.$emit=(s,o=null)=>{if(this.$parent)if(s.startsWith("update:")){let[h,l]=s.split(":");this.$parent.data=u=>{u[l]=o}}else if(s.startsWith("update"))this.$parent.data=h=>{Object.keys(o).forEach(l=>{h[l]=o[l]})};else{let{getInternalObject:h}=this.$parent;h[s]&&h[s](o)}},r.methods(n),this.view=r.view(n),this.getInternalObject=n,a(()=>{let s=r.follow?r.follow:[];s.length>0&&window.addEventListener("xtyleGlobalsUpdate",o=>{let{namespace:h}=o.detail;s.includes(h)&&this.render()})}),r.mounted.bind(n)()}get data(){return this.__dict__.state}set data(t){return this.__dict__.update(t)}render(){let t=D(...this.view())(this),e=I(this.$el,t);return this.$el=e,e}mount(t=null){this.$root?X(this.$root,this):(this.$root=t,X(t,this))}unmount(){this.$el.remove()}},p={[String]:"String",[Number]:"Number",[Function]:"Function",[Array]:"Array",[null]:"NULL",[Object]:"Object",[void 0]:"UNDEFINED"},Y=i=>typeof i=="string"?{name:p[String],type:String}:typeof i=="number"?{name:p[Number],type:Number}:typeof i=="function"?{name:p[Function],type:Function}:typeof i=="object"?Array.isArray(i)?{name:p[Array],type:Array}:i===null?{name:p[null],type:null}:{name:p[Object],type:Object}:{name:p[Function],type:void 0};function Z(i,t){let e=t||{},r={};return Object.keys(i.props).forEach(a=>{let c=e[a],s=i.props[a].type,o=p[s];if(c){s===String&&(c=c.toString());let h=Y(c);s===h.type||(["Function","Object","Array"].includes(o)?c=i.props[a].default():c=i.props[a].default,console.error(`prop: { ${a} } is not of the value { ${o} }`))}else["Function","Object","Array"].includes(o)?c=i.props[a].default():c=i.props[a].default;r[a]=c}),Object.assign({},{...i.data,...r})}function N(i,t){return Object.keys(i.methods).forEach(e=>{let r=i.methods[e];t[e]=r.bind(t)}),t}function tt(i,t){return i.view.bind(t)}function et(i){let t={follow:i.follow||[],sync:i.sync||{},props:i.props||{},data:i.data||{},methods:i.methods||{},view:i.view||function(){},components:i.components||{},mounted:i.mounted||function(){},init:i.init||function(){}},e={};return e.__keys__=Array.from(new Set([...Object.keys(t.props),...Object.keys(t.data)])),e.__methods__=Array.from(new Set(Object.keys(t.methods))),e.props=r=>Z(t,r),e.methods=r=>N(t,r),e.view=r=>tt(t,r),e.follow=t.follow,e.sync=t.sync,e.mounted=t.mounted,e.init=t.init,e}function M(i){let t=et(i),e=!1;function r(n){let a=n||{},c=t.props(a),s=$.model(c),o={};function h(u){Object.defineProperty(o,u,{get:function(){return s.state[u]},set:function(_){s.update(y=>y[u]=_)}})}t.__keys__.forEach(u=>{h(u)}),o.$slot=(u,_)=>a.$slot[u]?a.$slot[u](_):null,o.$update=u=>s.update(u);let l=u=>{e===!1&&(e=!0,u(),t.init.bind(o)())};return new d({component:t,internalObject:o,admin:s,init:l})}return r}function V(i){let t={};return i.forEach(e=>{t[e.name]=M(e)}),t}var w=M;var rt="xtyleGlobalsUpdate",A=class{constructor(t,e){this.key=t,this.value=e,this.left=null,this.right=null,this.height=1}},E=class{constructor(){this.root=null,this.__keys__=new Set}get keys(){return Array.from(this.__keys__)}create(t,e){return this.root=this._insert(t,e,this.root),this.__keys__.add(t),this}_insert(t,e,r){if(!r)return new A(t,e);t<r.key?r.left=this._insert(t,e,r.left):r.right=this._insert(t,e,r.right),r.height=1+Math.max(this._height(r.left),this._height(r.right));let n=this._getBalance(r);return n>1&&t<r.left.key?this._rotateRight(r):n<-1&&t>r.right.key?this._rotateLeft(r):n>1&&t>r.left.key?(r.left=this._rotateLeft(r.left),this._rotateRight(r)):n<-1&&t<r.right.key?(r.right=this._rotateRight(r.right),this._rotateLeft(r)):r}read(t){return this._find(t,this.root)}_find(t,e){return e?t===e.key?e.value:t<e.key?this._find(t,e.left):this._find(t,e.right):null}_height(t){return t?t.height:0}_getBalance(t){return t?this._height(t.left)-this._height(t.right):0}_rotateRight(t){let{left:e}=t,r=e.right;return e.right=t,t.left=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}_rotateLeft(t){let{right:e}=t,r=e.left;return e.left=t,t.right=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}update(t,e){let r=this.root;for(;r;){if(t===r.key)return r.value=e,!0;t<r.key?r=r.left:r=r.right}return!1}delete(t){this.root=this._delete(t,this.root)}_delete(t,e){if(!e)return null;if(t<e.key)e.left=this._delete(t,e.left);else if(t>e.key)e.right=this._delete(t,e.right);else{if(!e.left)return e.right;if(!e.right)return e.left;let n=this._findMinNode(e.right);e.key=n.key,e.value=n.value,e.right=this._delete(n.key,e.right)}e.height=1+Math.max(this._height(e.left),this._height(e.right));let r=this._getBalance(e);return r>1&&this._getBalance(e.left)>=0?this._rotateRight(e):r>1&&this._getBalance(e.left)<0?(e.left=this._rotateLeft(e.left),this._rotateRight(e)):r<-1&&this._getBalance(e.right)<=0?this._rotateLeft(e):r<-1&&this._getBalance(e.right)>0?(e.right=this._rotateRight(e.right),this._rotateLeft(e)):e}_findMinNode(t){return t.left?this._findMinNode(t.left):t}},b=new E;function it(i,t){Object.defineProperty(i,t,{get:function(){return i.$____state____$[t]},set:function(e){i.$____update____$(r=>r[t]=e)}})}var C=class{constructor(t,e){let r=Object.keys(e),n=t.toLowerCase();this.$____namespace____$=n,this.$____dict____$=e,this.$____keys____$=r,b.create(n,e),r.forEach(a=>{it(this,a)})}$redraw(){let{redraw:t}=window.$____XPRIVATEDICTX____$.router;t&&t()}get $update(){return this.$____update____$}get $store(){return b}get $____state____$(){return b.read(this.$____namespace____$)}$____update____$(t){let{data:e,update:r}=$.produce(this.$____dict____$,t);if(r){let n=this.$____namespace____$;this.$____dict____$=e,b.update(n,e);let a=new CustomEvent(rt,{detail:{namespace:n}});window.dispatchEvent(a)}}};function nt(i,t){return new C(i,t)}var F=nt;window.$____XPRIVATEDICTX____$={router:{},components:{},static:{},methods:{},vars:{},current:null};var m=window.$____XPRIVATEDICTX____$,st=w({props:{title:{type:String,default:"Oops!"}},view(){return["div",{style:"text-align: center"},[["h1",{style:"font-size: 8.5em"},[this.title]],["h3",{},"404 | Page not Found."]]]}});function O(i){return i="/"+i.replace(/^\/|\/$/g,"")+"/",i}function at(i){let t=new URLSearchParams(i),e={};return t.forEach((r,n)=>{e[n]=r}),e}function ot(i,t){let e=O(i),r=O(t),n=new RegExp(e.replace(/{(.*?)}/g,"([^/]+)")),a=r.match(n),c={};if(a){let s=e.match(/{(.*?)}/g);s&&s.forEach((o,h)=>{c[o.slice(1,-1)]=a[h+1]})}return c}function ct(i,t){let e=O(i),r=O(t);return new RegExp("^"+e.replace(/{(.*?)}/g,"([^/]+)")+"$").test(r)}function ht(i,t){let e=Object.keys(i).filter(r=>ct(r,t));return e.length>0?e[0]:"404"}function ut(i){let t=i||{},e=t.root?t.root:"#app",r=t.history?t.history:!1,n=t.routes?t.routes:{},a=t.components?t.components:[],c=t.methods?t.methods:{},s=t.static?t.static:{},o=t.vars?t.vars:{},h=null,l=null,u=null,_=null,y={},k={};r||window.location.hash||(window.location.hash="/");let U=f=>{let g=window.event;if(g)try{g.preventDefault&&g.preventDefault(),g.stopPropagation&&g.stopPropagation(),g.stopImmediatePropagation&&g.stopImmediatePropagation()}catch(K){}r?window.history.pushState({},"",f):window.location.hash=f,v()};async function v(){_=r?window.location.pathname:window.location.hash.slice(1),u=ht(n,_);let f=_.split("?");y=ot(u,f[0]),f.length>1&&(k=at(f[1])),l=n[u]||n[404]||st,h&&h.unmount(),l&&(h=l(),h.mount(e),m.current=h)}function G(){h.render()}window.onpopstate=v;let T={go:f=>U(f),redraw:()=>G()};return Object.defineProperty(T,"current",{get:function(){return Object.freeze({route:u,path:_,args:y,query:k})}}),m.components=V(a),m.router=T,m.methods=c,m.static=s,m.vars=o,Object.keys(o).forEach(f=>{m.vars[f]=F(f,o[f])}),v(),window.$____XPRIVATEDICTX____$}var W=ut;var At={h:w,app:W};export{At as default};
