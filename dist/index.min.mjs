/*! @License MIT | Copyright (c) 2022 hlop3z */
function j(i,...t){return t.forEach(e=>{for(let r in e)e[r]instanceof Object?(i[r]||Object.assign(i,{[r]:{}}),j(i[r],e[r])):Object.assign(i,{[r]:e[r]})}),i}function L(i,t,e=!1){return j(e?Object.assign({},i):i,t)}function x(i,t){if(i===t)return!0;if(typeof i!="object"||i===null||typeof t!="object"||t===null)return!1;let e=Object.keys(i),r=Object.keys(t);if(e.length!==r.length)return!1;for(let n of e)if(!r.includes(n)||!x(i[n],t[n]))return!1;return!0}function R(i,t){let e=Object.assign({},i);t(e);let r=L(i,e,!0),n=x(i,r);return{data:r,update:!n}}var P=class{constructor(t){let e={...t};this.original=e,this.current=e,this.vdom=null}get state(){return this.current}set state(t){this.update(t)}update(t){let{data:e,update:r}=R(this.current,t);r&&(this.current=e,this.vdom&&this.vdom.render())}reset(){this.current=this.original}};function z(i,t){return new P(i,t)}var $={model:z,produce:R,compare:x,merge:L};function B(i,t){if(!i)return t;if(!t)return i.remove(),null;if(i.key!==t.key||q(i,t)||i.tagName!==t.tagName)return i.replaceWith(t),t;let e=i.attributes,r=t.attributes,n=Q(e,r);for(let o=0;o<n.length;o++){let a=n[o];i.setAttribute(a.name,a.value)}return H(i,t),i}function q(i,t){return i.textContent!==t.textContent}function Q(i,t){let e=[];if(i)for(let r=0;r<t.length;r++){let n=t[r],o=i.getNamedItem(n.name);(!o||o.value!==n.value)&&e.push({name:n.name,value:n.value})}return e}function H(i,t){let e=Array.from(i.childNodes),r=Array.from(t.childNodes);for(let n=0;n<r.length||n<e.length;n++){let o=r[n],a=e[n],s=B(a,o);s&&!i.contains(s)&&i.appendChild(s)}}var S=B;var J=["click","dblclick","mousedown","mouseup","contextmenu","mouseout","mousewheel","mouseover","touchstart","touchend","touchmove","touchcancel","keydown","keyup","keypress","focus","blur","change","submit","resize","scroll","hashchange"];function I(i,t,e){if(!i)return()=>null;let r=document.createElement(i);function n(o=null){let a={};for(let s in t){if(s==="show"&&t[s]===!1)return r.hidden=!0,r;if(s!=="key"&&s!=="show")if(s.startsWith("@")){let h=s.slice(1);J.includes(h)&&r.addEventListener(h,t[s])}else s==="class"?Array.isArray(t[s])?r.setAttribute(s,t[s].join(" ")):t[s]&&r.setAttribute(s,t[s]):r.setAttribute(s,t[s])}return Array.isArray(e)||(e=[e]),e.forEach(s=>{if(s)if(s instanceof d){s.$root=r,s.$parent=o;let h=s.render();h&&r.appendChild(h)}else typeof s=="object"?r.appendChild(I(...s)()):r.appendChild(document.createTextNode(s))}),r}return n}var D=I;function V(i,t){if(typeof i=="string"){let e=document.querySelector(i),r=t.render();t.$el=r,e.appendChild(r)}else{let e=t.render();t.$el=e,i.appendChild(e)}}var d=class{constructor(t){this.$el=null,this.$root=null,this.$parent=null;let{admin:e,component:r,internalObject:n,init:o}=t;this.__dict__=e,e.vdom=this,Object.defineProperty(n,"$el",{get:()=>this.$el}),Object.defineProperty(n,"$parent",{get:()=>this.$parent}),Object.defineProperty(n,"$gui",{get:()=>window.$____XPRIVATEDICTX____$.components}),Object.defineProperty(n,"$ui",{get:()=>window.$____XPRIVATEDICTX____$}),Object.keys(r.sync).forEach(a=>{let s=r.sync[a];Object.defineProperty(n,a,{get:()=>this.$parent.data[s],set:h=>{this.$parent.data=c=>{c[s]=h}}})}),n.$emit=(a,s=null)=>{if(this.$parent)if(a.startsWith("update:")){let[h,c]=a.split(":");this.$parent.data=_=>{_[c]=s}}else if(a.startsWith("update"))this.$parent.data=h=>{Object.keys(s).forEach(c=>{h[c]=s[c]})};else{let{getInternalObject:h}=this.$parent;h[a]&&h[a](s)}},r.methods(n),this.view=r.view(n),this.getInternalObject=n,this.$events={},this.$events.init=()=>o(()=>{let a=r.follow?r.follow:[];a.length>0&&window.addEventListener("xtyleGlobalsUpdate",s=>{let{namespace:h}=s.detail;a.includes(h)&&this.render()})}),this.$events.mounted=r.mounted.bind(n)}get data(){return this.__dict__.state}set data(t){return this.__dict__.update(t)}render(){let t=this.view();if(t){let e=D(...t)(this);this.$el=S(this.$el,e)}return this.$events.init(),this.$events.mounted(),this.$el}mount(t=null){this.$root?V(this.$root,this):(this.$root=t,V(t,this))}unmount(){this.$el.remove()}},f={[String]:"String",[Number]:"Number",[Function]:"Function",[Array]:"Array",[null]:"NULL",[Object]:"Object",[Boolean]:"Boolean",[void 0]:"UNDEFINED"},Y=i=>typeof i=="string"?{name:f[String],type:String}:typeof i=="number"?{name:f[Number],type:Number}:typeof i=="boolean"?{name:f[Boolean],type:Boolean}:typeof i=="function"?{name:f[Function],type:Function}:typeof i=="object"?Array.isArray(i)?{name:f[Array],type:Array}:i===null?{name:f[null],type:null}:{name:f[Object],type:Object}:{name:f[Function],type:void 0};function Z(i,t){let e=t||{},r={};return Object.keys(i.props).forEach(o=>{let a=e[o],s=i.props[o].type,h=f[s];if(a&&s!==Boolean){s===String&&(a=a.toString());let c=Y(a);s===c.type||(["Function","Object","Array"].includes(h)?a=i.props[o].default():a=i.props[o].default,console.error(`prop: { ${o} } is not of the value { ${h} }`))}else s===Boolean?a=a===void 0?null:a:["Function","Object","Array"].includes(h)?a=i.props[o].default():a=i.props[o].default;r[o]=a}),Object.assign({},{...i.data,...r})}function N(i,t){return Object.keys(i.methods).forEach(e=>{let r=i.methods[e];t[e]=r.bind(t)}),t}function tt(i,t){return i.view.bind(t)}function et(i){let t={follow:i.follow||[],sync:i.sync||{},props:i.props||{},data:i.data||{},methods:i.methods||{},view:i.view||function(){},components:i.components||{},mounted:i.mounted||function(){},init:i.init||function(){}},e={};return e.__keys__=Array.from(new Set([...Object.keys(t.props),...Object.keys(t.data)])),e.__methods__=Array.from(new Set(Object.keys(t.methods))),e.props=r=>Z(t,r),e.methods=r=>N(t,r),e.view=r=>tt(t,r),e.follow=t.follow,e.sync=t.sync,e.mounted=t.mounted,e.init=t.init,e}function X(i){let t=et(i),e=!1;function r(n){let o=n||{},a=t.props(o),s=$.model(a),h={};function c(l){Object.defineProperty(h,l,{get:function(){return s.state[l]},set:function(p){s.update(y=>y[l]=p)}})}t.__keys__.forEach(l=>{c(l)}),h.$slot=(l,p)=>o.$slot[l]?o.$slot[l](p):null,h.$update=l=>s.update(l);let _=l=>{e===!1&&(e=!0,l(),t.init.bind(h)())};return new d({component:t,internalObject:h,admin:s,init:_})}return r}function M(i){let t={};return i.forEach(e=>{t[e.name]=X(e)}),t}var w=X;var rt="xtyleGlobalsUpdate",A=class{constructor(t,e){this.key=t,this.value=e,this.left=null,this.right=null,this.height=1}},E=class{constructor(){this.root=null,this.__keys__=new Set}get keys(){return Array.from(this.__keys__)}create(t,e){return this.root=this._insert(t,e,this.root),this.__keys__.add(t),this}_insert(t,e,r){if(!r)return new A(t,e);t<r.key?r.left=this._insert(t,e,r.left):r.right=this._insert(t,e,r.right),r.height=1+Math.max(this._height(r.left),this._height(r.right));let n=this._getBalance(r);return n>1&&t<r.left.key?this._rotateRight(r):n<-1&&t>r.right.key?this._rotateLeft(r):n>1&&t>r.left.key?(r.left=this._rotateLeft(r.left),this._rotateRight(r)):n<-1&&t<r.right.key?(r.right=this._rotateRight(r.right),this._rotateLeft(r)):r}read(t){return this._find(t,this.root)}_find(t,e){return e?t===e.key?e.value:t<e.key?this._find(t,e.left):this._find(t,e.right):null}_height(t){return t?t.height:0}_getBalance(t){return t?this._height(t.left)-this._height(t.right):0}_rotateRight(t){let{left:e}=t,r=e.right;return e.right=t,t.left=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}_rotateLeft(t){let{right:e}=t,r=e.left;return e.left=t,t.right=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}update(t,e){let r=this.root;for(;r;){if(t===r.key)return r.value=e,!0;t<r.key?r=r.left:r=r.right}return!1}delete(t){this.root=this._delete(t,this.root)}_delete(t,e){if(!e)return null;if(t<e.key)e.left=this._delete(t,e.left);else if(t>e.key)e.right=this._delete(t,e.right);else{if(!e.left)return e.right;if(!e.right)return e.left;let n=this._findMinNode(e.right);e.key=n.key,e.value=n.value,e.right=this._delete(n.key,e.right)}e.height=1+Math.max(this._height(e.left),this._height(e.right));let r=this._getBalance(e);return r>1&&this._getBalance(e.left)>=0?this._rotateRight(e):r>1&&this._getBalance(e.left)<0?(e.left=this._rotateLeft(e.left),this._rotateRight(e)):r<-1&&this._getBalance(e.right)<=0?this._rotateLeft(e):r<-1&&this._getBalance(e.right)>0?(e.right=this._rotateRight(e.right),this._rotateLeft(e)):e}_findMinNode(t){return t.left?this._findMinNode(t.left):t}},b=new E;function it(i,t){Object.defineProperty(i,t,{get:function(){return i.$____state____$[t]},set:function(e){i.$____update____$(r=>r[t]=e)}})}var C=class{constructor(t,e){let r=Object.keys(e),n=t.toLowerCase();this.$____namespace____$=n,this.$____dict____$=e,this.$____keys____$=r,b.create(n,e),r.forEach(o=>{it(this,o)})}$redraw(){let{redraw:t}=window.$____XPRIVATEDICTX____$.router;t&&t()}get $update(){return this.$____update____$}get $store(){return b}get $____state____$(){return b.read(this.$____namespace____$)}$____update____$(t){let{data:e,update:r}=$.produce(this.$____dict____$,t);if(r){let n=this.$____namespace____$;this.$____dict____$=e,b.update(n,e);let o=new CustomEvent(rt,{detail:{namespace:n}});window.dispatchEvent(o)}}};function nt(i,t){return new C(i,t)}var F=nt;window.$____XPRIVATEDICTX____$={router:{},components:{},static:{},methods:{},vars:{},current:null};var g=window.$____XPRIVATEDICTX____$,st=w({props:{title:{type:String,default:"Oops!"}},view(){return["div",{style:"text-align: center"},[["h1",{style:"font-size: 8.5em"},[this.title]],["h3",{},"404 | Page not Found."]]]}});function v(i){return i="/"+i.replace(/^\/|\/$/g,"")+"/",i}function at(i){let t=new URLSearchParams(i),e={};return t.forEach((r,n)=>{e[n]=r}),e}function ot(i,t){let e=v(i),r=v(t),n=new RegExp(e.replace(/{(.*?)}/g,"([^/]+)")),o=r.match(n),a={};if(o){let s=e.match(/{(.*?)}/g);s&&s.forEach((h,c)=>{a[h.slice(1,-1)]=o[c+1]})}return a}function ht(i,t){let e=v(i),r=v(t);return new RegExp("^"+e.replace(/{(.*?)}/g,"([^/]+)")+"$").test(r)}function ct(i,t){let e=Object.keys(i).filter(r=>ht(r,t));return e.length>0?e[0]:"404"}function lt(i){let t=i||{},e=t.root?t.root:"#app",r=t.history?t.history:!1,n=t.routes?t.routes:{},o=t.components?t.components:[],a=t.methods?t.methods:{},s=t.static?t.static:{},h=t.vars?t.vars:{},c=null,_=null,l=null,p=null,y={},k={};r||window.location.hash||(window.location.hash="/");let U=u=>{let m=window.event;if(m)try{m.preventDefault&&m.preventDefault(),m.stopPropagation&&m.stopPropagation(),m.stopImmediatePropagation&&m.stopImmediatePropagation()}catch(K){}r?window.history.pushState({},"",u):window.location.hash=u,O()};async function O(){p=r?window.location.pathname:window.location.hash.slice(1),l=ct(n,p);let u=p.split("?");y=ot(l,u[0]),u.length>1&&(k=at(u[1])),_=n[l]||n[404]||st,c&&c.unmount(),_&&(c=_(),c.mount(e),g.current=c)}function G(){c.render()}window.onpopstate=O;let T={go:u=>U(u),redraw:()=>G()};return Object.defineProperty(T,"current",{get:function(){return Object.freeze({route:l,path:p,args:y,query:k})}}),g.components=M(o),g.router=T,g.methods=a,g.static=s,g.vars=h,Object.keys(h).forEach(u=>{g.vars[u]=F(u,h[u])}),O(),window.$____XPRIVATEDICTX____$}var W=lt;var At={h:w,app:W};export{At as default};
