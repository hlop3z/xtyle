/*! @License MIT | Copyright (c) 2022 hlop3z */
function j(n,...t){return t.forEach(e=>{for(let r in e)e[r]instanceof Object?(n[r]||Object.assign(n,{[r]:{}}),j(n[r],e[r])):Object.assign(n,{[r]:e[r]})}),n}function B(n,t,e=!1){return j(e?Object.assign({},n):n,t)}function x(n,t){if(n===t)return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;let e=Object.keys(n),r=Object.keys(t);if(e.length!==r.length)return!1;for(let i of e)if(!r.includes(i)||!x(n[i],t[i]))return!1;return!0}function S(n,t){let e=Object.assign({},n);t(e);let r=B(n,e,!0),i=x(n,r);return{data:r,update:!i}}var A=class{constructor(t){let e={...t};this.original=e,this.current=e,this.vdom=null}get state(){return this.current}set state(t){this.update(t)}update(t){let{data:e,update:r}=S(this.current,t);r&&(this.current=e,this.vdom&&this.vdom.render())}reset(){this.current=this.original}};function H(n,t){return new A(n,t)}var $={model:H,produce:S,compare:x,merge:B};function I(n,t){if(!n)return t;if(!t)return n.remove(),null;if(n.key!==t.key||J(n,t)||n.tagName!==t.tagName)return n.replaceWith(t),t;let e=n.attributes,r=t.attributes,i=Y(e,r);for(let a=0;a<i.length;a++){let o=i[a];n.setAttribute(o.name,o.value)}return Z(n,t),n}function J(n,t){return n.textContent!==t.textContent}function Y(n,t){let e=[];if(n)for(let r=0;r<t.length;r++){let i=t[r],a=n.getNamedItem(i.name);(!a||a.value!==i.value)&&e.push({name:i.name,value:i.value})}return e}function Z(n,t){let e=Array.from(n.childNodes),r=Array.from(t.childNodes);for(let i=0;i<r.length||i<e.length;i++){let a=r[i],o=e[i],s=I(o,a);s&&!n.contains(s)&&n.appendChild(s)}}var D=I;var V=["click","dblclick","mousedown","mouseup","contextmenu","mouseout","mousewheel","mouseover","touchstart","touchend","touchmove","touchcancel","keydown","keyup","keypress","focus","blur","change","submit","resize","scroll","hashchange"];function E(n,t,e){if(!n)return()=>null;if(n==="template")return E(...e[0]);let r=document.createElement(n);function i(a=null){let o={};for(let s in t){if(s==="show"&&t[s]===!1)return r.hidden=!0,r;if(s!=="key"&&s!=="show")if(s.startsWith("x-on:")){let c=s.slice(5);V.includes(c)&&r.addEventListener(c,t[s])}else s==="class"?Array.isArray(t[s])?r.setAttribute(s,t[s].join(" ")):t[s]&&r.setAttribute(s,t[s]):r.setAttribute(s,t[s])}return Array.isArray(e)||(e=[e]),e.forEach(s=>{if(s)if(s instanceof d){s.$root=r,s.$parent=a;let c=s.render();c&&r.appendChild(c)}else typeof s=="object"?s[0]==="template"?P(...s[2]).forEach(c=>{r.appendChild(c)}):r.appendChild(E(...s)()):r.appendChild(document.createTextNode(s))}),r}return i}var X=E;function M(n){if(typeof n!="string"&&n){let[t,e,r]=n,i=document.createElement(t);if(e)for(let a in e){if(a==="show"&&e[a]===!1)return i.hidden=!0,i;if(a!=="key"&&a!=="show")if(a.startsWith("x-on:")){let o=a.slice(5);V.includes(o)&&i.addEventListener(o,e[a])}else a==="class"?Array.isArray(e[a])?i.setAttribute(a,e[a].join(" ")):e[a]&&i.setAttribute(a,e[a]):i.setAttribute(a,e[a])}return r.forEach(a=>{i.appendChild(M(a))}),i}else return document.createTextNode(n)}function P(...n){return n.map(t=>M(t))}function F(n,t){if(typeof n=="string"){let e=document.querySelector(n),r=t.render();t.$el=r,e.replaceWith(r)}else{let e=n,r=t.render();t.$el=r,e.appendChild(r),e.replaceWith(r)}}var d=class{constructor(t){this.$el=null,this.$root=null,this.$parent=null;let{admin:e,component:r,internalObject:i,init:a}=t;this.__dict__=e,e.vdom=this,Object.defineProperty(i,"$el",{get:()=>this.$el}),Object.defineProperty(i,"$parent",{get:()=>this.$parent}),Object.defineProperty(i,"$gui",{get:()=>window.$____XPRIVATEDICTX____$.components}),Object.defineProperty(i,"$ui",{get:()=>window.$____XPRIVATEDICTX____$}),Object.keys(r.sync).forEach(o=>{let s=r.sync[o];Object.defineProperty(i,o,{get:()=>this.$parent.data[s],set:c=>{this.$parent.data=l=>{l[s]=c}}})}),i.$emit=(o,s=null)=>{if(this.$parent)if(o.startsWith("update:")){let[c,l]=o.split(":");this.$parent.data=_=>{_[l]=s}}else if(o.startsWith("update"))this.$parent.data=c=>{Object.keys(s).forEach(l=>{c[l]=s[l]})};else{let{getInternalObject:c}=this.$parent;c[o]&&c[o](s)}},r.methods(i),this.view=r.view(i),this.getInternalObject=i,this.$events={},this.$events.init=()=>a(()=>{let o=r.follow?r.follow:[];o.length>0&&window.addEventListener("xtyleGlobalsUpdate",s=>{let{namespace:c}=s.detail;o.includes(c)&&this.render()})}),this.$events.mounted=r.mounted.bind(i)}get data(){return this.__dict__.state}set data(t){return this.__dict__.update(t)}render(){let t=this.view();if(t){let e=X(...t)(this);this.$el=D(this.$el,e)}return this.$events.init(),this.$events.mounted(),this.$el}mount(t=null){this.$root?F(this.$root,this):(this.$root=t,F(t,this))}unmount(){this.$el.remove()}},f={[String]:"String",[Number]:"Number",[Function]:"Function",[Array]:"Array",[null]:"NULL",[Object]:"Object",[Boolean]:"Boolean",[void 0]:"UNDEFINED"},N=n=>typeof n=="string"?{name:f[String],type:String}:typeof n=="number"?{name:f[Number],type:Number}:typeof n=="boolean"?{name:f[Boolean],type:Boolean}:typeof n=="function"?{name:f[Function],type:Function}:typeof n=="object"?Array.isArray(n)?{name:f[Array],type:Array}:n===null?{name:f[null],type:null}:{name:f[Object],type:Object}:{name:f[Function],type:void 0};function tt(n,t){let e=t||{},r={};return Object.keys(n.props).forEach(a=>{let o=e[a],s=n.props[a].type,c=f[s];if(o&&s!==Boolean){s===String&&(o=o.toString());let l=N(o);s===l.type||(["Function","Object","Array"].includes(c)?o=n.props[a].default():o=n.props[a].default,console.error(`prop: { ${a} } is not of the value { ${c} }`))}else s===Boolean?o=o===void 0?null:o:["Function","Object","Array"].includes(c)?o=n.props[a].default():o=n.props[a].default;r[a]=o}),Object.assign({},{...n.data,...r})}function et(n,t){return Object.keys(n.methods).forEach(e=>{let r=n.methods[e];t[e]=r.bind(t)}),t}function rt(n,t){return n.view.bind(t)}function nt(n){let t={follow:n.follow||[],sync:n.sync||{},props:n.props||{},data:n.data||{},methods:n.methods||{},view:n.view||function(){},components:n.components||{},mounted:n.mounted||function(){},init:n.init||function(){}},e={};return e.__keys__=Array.from(new Set([...Object.keys(t.props),...Object.keys(t.data)])),e.__methods__=Array.from(new Set(Object.keys(t.methods))),e.props=r=>tt(t,r),e.methods=r=>et(t,r),e.view=r=>rt(t,r),e.follow=t.follow,e.sync=t.sync,e.mounted=t.mounted,e.init=t.init,e}function W(n){let t=nt(n),e=!1;function r(i){let a=i||{},o=t.props(a),s=$.model(o),c={};function l(h){Object.defineProperty(c,h,{get:function(){return s.state[h]},set:function(p){s.update(y=>y[h]=p)}})}t.__keys__.forEach(h=>{l(h)}),c.$slot=(h,p)=>a.$slot[h]?a.$slot[h](p):null,c.$update=h=>s.update(h);let _=h=>{e===!1&&(e=!0,h(),t.init.bind(c)())};return new d({component:t,internalObject:c,admin:s,init:_})}return r}function U(n){let t={};return n.forEach(e=>{t[e.name]=W(e)}),t}var w=W;var it="xtyleGlobalsUpdate",C=class{constructor(t,e){this.key=t,this.value=e,this.left=null,this.right=null,this.height=1}},k=class{constructor(){this.root=null,this.__keys__=new Set}get keys(){return Array.from(this.__keys__)}create(t,e){return this.root=this._insert(t,e,this.root),this.__keys__.add(t),this}_insert(t,e,r){if(!r)return new C(t,e);t<r.key?r.left=this._insert(t,e,r.left):r.right=this._insert(t,e,r.right),r.height=1+Math.max(this._height(r.left),this._height(r.right));let i=this._getBalance(r);return i>1&&t<r.left.key?this._rotateRight(r):i<-1&&t>r.right.key?this._rotateLeft(r):i>1&&t>r.left.key?(r.left=this._rotateLeft(r.left),this._rotateRight(r)):i<-1&&t<r.right.key?(r.right=this._rotateRight(r.right),this._rotateLeft(r)):r}read(t){return this._find(t,this.root)}_find(t,e){return e?t===e.key?e.value:t<e.key?this._find(t,e.left):this._find(t,e.right):null}_height(t){return t?t.height:0}_getBalance(t){return t?this._height(t.left)-this._height(t.right):0}_rotateRight(t){let{left:e}=t,r=e.right;return e.right=t,t.left=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}_rotateLeft(t){let{right:e}=t,r=e.left;return e.left=t,t.right=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}update(t,e){let r=this.root;for(;r;){if(t===r.key)return r.value=e,!0;t<r.key?r=r.left:r=r.right}return!1}delete(t){this.root=this._delete(t,this.root)}_delete(t,e){if(!e)return null;if(t<e.key)e.left=this._delete(t,e.left);else if(t>e.key)e.right=this._delete(t,e.right);else{if(!e.left)return e.right;if(!e.right)return e.left;let i=this._findMinNode(e.right);e.key=i.key,e.value=i.value,e.right=this._delete(i.key,e.right)}e.height=1+Math.max(this._height(e.left),this._height(e.right));let r=this._getBalance(e);return r>1&&this._getBalance(e.left)>=0?this._rotateRight(e):r>1&&this._getBalance(e.left)<0?(e.left=this._rotateLeft(e.left),this._rotateRight(e)):r<-1&&this._getBalance(e.right)<=0?this._rotateLeft(e):r<-1&&this._getBalance(e.right)>0?(e.right=this._rotateRight(e.right),this._rotateLeft(e)):e}_findMinNode(t){return t.left?this._findMinNode(t.left):t}},b=new k;function st(n,t){Object.defineProperty(n,t,{get:function(){return n.$____state____$[t]},set:function(e){n.$____update____$(r=>r[t]=e)}})}var T=class{constructor(t,e){let r=Object.keys(e),i=t.toLowerCase();this.$____namespace____$=i,this.$____dict____$=e,this.$____keys____$=r,b.create(i,e),r.forEach(a=>{st(this,a)})}$redraw(){let{redraw:t}=window.$____XPRIVATEDICTX____$.router;t&&t()}get $update(){return this.$____update____$}get $store(){return b}get $____state____$(){return b.read(this.$____namespace____$)}$____update____$(t){let{data:e,update:r}=$.produce(this.$____dict____$,t);if(r){let i=this.$____namespace____$;this.$____dict____$=e,b.update(i,e);let a=new CustomEvent(it,{detail:{namespace:i}});window.dispatchEvent(a)}}};function at(n,t){return new T(n,t)}var G=at;window.$____XPRIVATEDICTX____$={router:{},components:{},static:{},methods:{},vars:{},current:null};var g=window.$____XPRIVATEDICTX____$,ot=w({props:{title:{type:String,default:"Oops!"}},view(){return["div",{style:"text-align: center"},[["h1",{style:"font-size: 8.5em"},[this.title]],["h3",{},"404 | Page not Found."]]]}});function v(n){return n="/"+n.replace(/^\/|\/$/g,"")+"/",n}function ct(n){let t=new URLSearchParams(n),e={};return t.forEach((r,i)=>{e[i]=r}),e}function lt(n,t){let e=v(n),r=v(t),i=new RegExp(e.replace(/{(.*?)}/g,"([^/]+)")),a=r.match(i),o={};if(a){let s=e.match(/{(.*?)}/g);s&&s.forEach((c,l)=>{o[c.slice(1,-1)]=a[l+1]})}return o}function ht(n,t){let e=v(n),r=v(t);return new RegExp("^"+e.replace(/{(.*?)}/g,"([^/]+)")+"$").test(r)}function ut(n,t){let e=Object.keys(n).filter(r=>ht(r,t));return e.length>0?e[0]:"404"}function ft(n){let t=n||{},e=t.root?t.root:"#app",r=t.history?t.history:!1,i=t.routes?t.routes:{},a=t.components?t.components:[],o=t.methods?t.methods:{},s=t.static?t.static:{},c=t.vars?t.vars:{},l=null,_=null,h=null,p=null,y={},L={};r||window.location.hash||(window.location.hash="/");let z=u=>{let m=window.event;if(m)try{m.preventDefault&&m.preventDefault(),m.stopPropagation&&m.stopPropagation(),m.stopImmediatePropagation&&m.stopImmediatePropagation()}catch(Q){}r?window.history.pushState({},"",u):window.location.hash=u,O()};async function O(){p=r?window.location.pathname:window.location.hash.slice(1),h=ut(i,p);let u=p.split("?");y=lt(h,u[0]),u.length>1&&(L=ct(u[1])),_=i[h]||i[404]||ot,l&&l.unmount(),_&&(l=_(),l.mount(e),g.current=l)}function q(){l.render()}window.onpopstate=O;let R={go:u=>z(u),redraw:()=>q()};return Object.defineProperty(R,"current",{get:function(){return Object.freeze({route:h,path:p,args:y,query:L})}}),g.components=U(a),g.router=R,g.methods=o,g.static=s,g.vars=c,Object.keys(c).forEach(u=>{g.vars[u]=G(u,c[u])}),O(),window.$____XPRIVATEDICTX____$}var K=ft;var kt={h:w,app:K,f:P};export{kt as default};
