/*! @License MIT | Copyright (c) 2022 hlop3z */
function v(n,...t){return t.forEach(e=>{for(let r in e)e[r]instanceof Object?(n[r]||Object.assign(n,{[r]:{}}),v(n[r],e[r])):Object.assign(n,{[r]:e[r]})}),n}function L(n,t,e=!1){return v(e?Object.assign({},n):n,t)}function x(n,t){if(n===t)return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;let e=Object.keys(n),r=Object.keys(t);if(e.length!==r.length)return!1;for(let i of e)if(!r.includes(i)||!x(n[i],t[i]))return!1;return!0}function R(n,t){let e=Object.assign({},n);t(e);let r=L(n,e,!0),i=x(n,r);return{data:r,update:!i}}var P=class{constructor(t){let e={...t};this.original=e,this.current=e,this.vdom=null}get state(){return this.current}set state(t){this.update(t)}update(t){let{data:e,update:r}=R(this.current,t);r&&(this.current=e,this.vdom&&this.vdom.render())}reset(){this.current=this.original}};function z(n,t){return new P(n,t)}var $={model:z,produce:R,compare:x,merge:L};function B(n,t){if(!n)return t;if(!t)return n.remove(),null;if(n.key!==t.key||q(n,t)||n.tagName!==t.tagName)return n.replaceWith(t),t;let e=n.attributes,r=t.attributes,i=Q(e,r);for(let a=0;a<i.length;a++){let c=i[a];n.setAttribute(c.name,c.value)}return H(n,t),n}function q(n,t){return n.textContent!==t.textContent}function Q(n,t){let e=[];if(n)for(let r=0;r<t.length;r++){let i=t[r],a=n.getNamedItem(i.name);(!a||a.value!==i.value)&&e.push({name:i.name,value:i.value})}return e}function H(n,t){let e=Array.from(n.childNodes),r=Array.from(t.childNodes);for(let i=0;i<r.length||i<e.length;i++){let a=r[i],c=e[i],s=B(c,a);s&&!n.contains(s)&&n.appendChild(s)}}var S=B;var J=["click","dblclick","mousedown","mouseup","contextmenu","mouseout","mousewheel","mouseover","touchstart","touchend","touchmove","touchcancel","keydown","keyup","keypress","focus","blur","change","submit","resize","scroll","hashchange"];function I(n,t,e){let r=document.createElement(n);function i(a=null){let c={};for(let s in t){if(s==="show"&&t[s]===!1)return r.hidden=!0,r;if(s!=="key"&&s!=="show")if(s.startsWith("@")){let o=s.slice(1);J.includes(o)&&r.addEventListener(o,t[s])}else s==="class"?Array.isArray(t[s])?r.setAttribute(s,t[s].join(" ")):t[s]&&r.setAttribute(s,t[s]):r.setAttribute(s,t[s])}return Array.isArray(e)||(e=[e]),e.forEach(s=>{s&&(s instanceof d?(s.$root=r,s.$parent=a,r.appendChild(s.render())):typeof s=="object"?r.appendChild(I(...s)()):r.appendChild(document.createTextNode(s)))}),r}return i}var D=I;function V(n,t){if(typeof n=="string"){let e=document.querySelector(n),r=t.render();t.$el=r,e.appendChild(r)}else{let e=t.render();t.$el=e,n.appendChild(e)}}var d=class{constructor(t){this.$el=null,this.$root=null,this.$parent=null;let{admin:e,component:r,internalObject:i,init:a}=t;this.__dict__=e,e.vdom=this,Object.defineProperty(i,"$el",{get:()=>this.$el}),Object.defineProperty(i,"$parent",{get:()=>this.$parent}),Object.defineProperty(i,"$gui",{get:()=>window.$____XPRIVATEDICTX____$.components}),Object.defineProperty(i,"$ui",{get:()=>window.$____XPRIVATEDICTX____$}),Object.keys(r.sync).forEach(s=>{let o=r.sync[s];Object.defineProperty(i,s,{get:()=>this.$parent.data[o],set:h=>{this.$parent.data=u=>{u[o]=h}}})}),i.$emit=(s,o=null)=>{if(this.$parent)if(s.startsWith("update:")){let[h,u]=s.split(":");this.$parent.data=l=>{l[u]=o}}else if(s.startsWith("update"))this.$parent.data=h=>{Object.keys(o).forEach(u=>{h[u]=o[u]})};else{let{getInternalObject:h}=this.$parent;h[s]&&h[s](o)}},r.methods(i),this.view=r.view(i),this.getInternalObject=i,a(()=>{let s=r.follow?r.follow:[];s.length>0&&window.addEventListener("xtyleGlobalsUpdate",o=>{let{namespace:h}=o.detail;s.includes(h)&&this.render()})}),r.mounted.bind(i)()}get data(){return this.__dict__.state}set data(t){return this.__dict__.update(t)}render(){let t=D(...this.view())(this),e=S(this.$el,t);return this.$el=e,e}mount(t=null){this.$root?V(this.$root,this):(this.$root=t,V(t,this))}unmount(){this.$el.remove()}},_={[String]:"String",[Number]:"Number",[Function]:"Function",[Array]:"Array",[null]:"NULL",[Object]:"Object",[Boolean]:"Boolean",[void 0]:"UNDEFINED"},Y=n=>typeof n=="string"?{name:_[String],type:String}:typeof n=="number"?{name:_[Number],type:Number}:typeof n=="boolean"?{name:_[Boolean],type:Boolean}:typeof n=="function"?{name:_[Function],type:Function}:typeof n=="object"?Array.isArray(n)?{name:_[Array],type:Array}:n===null?{name:_[null],type:null}:{name:_[Object],type:Object}:{name:_[Function],type:void 0};function Z(n,t){let e=t||{},r={};return Object.keys(n.props).forEach(a=>{let c=e[a],s=n.props[a].type,o=_[s];if(c&&s!==Boolean){s===String&&(c=c.toString());let h=Y(c);s===h.type||(["Function","Object","Array"].includes(o)?c=n.props[a].default():c=n.props[a].default,console.error(`prop: { ${a} } is not of the value { ${o} }`))}else s===Boolean?c=c===void 0?null:c:["Function","Object","Array"].includes(o)?c=n.props[a].default():c=n.props[a].default;r[a]=c}),Object.assign({},{...n.data,...r})}function N(n,t){return Object.keys(n.methods).forEach(e=>{let r=n.methods[e];t[e]=r.bind(t)}),t}function tt(n,t){return n.view.bind(t)}function et(n){let t={follow:n.follow||[],sync:n.sync||{},props:n.props||{},data:n.data||{},methods:n.methods||{},view:n.view||function(){},components:n.components||{},mounted:n.mounted||function(){},init:n.init||function(){}},e={};return e.__keys__=Array.from(new Set([...Object.keys(t.props),...Object.keys(t.data)])),e.__methods__=Array.from(new Set(Object.keys(t.methods))),e.props=r=>Z(t,r),e.methods=r=>N(t,r),e.view=r=>tt(t,r),e.follow=t.follow,e.sync=t.sync,e.mounted=t.mounted,e.init=t.init,e}function X(n){let t=et(n),e=!1;function r(i){let a=i||{},c=t.props(a),s=$.model(c),o={};function h(l){Object.defineProperty(o,l,{get:function(){return s.state[l]},set:function(p){s.update(y=>y[l]=p)}})}t.__keys__.forEach(l=>{h(l)}),o.$slot=(l,p)=>a.$slot[l]?a.$slot[l](p):null,o.$update=l=>s.update(l);let u=l=>{e===!1&&(e=!0,l(),t.init.bind(o)())};return new d({component:t,internalObject:o,admin:s,init:u})}return r}function M(n){let t={};return n.forEach(e=>{t[e.name]=X(e)}),t}var w=X;var rt="xtyleGlobalsUpdate",A=class{constructor(t,e){this.key=t,this.value=e,this.left=null,this.right=null,this.height=1}},E=class{constructor(){this.root=null,this.__keys__=new Set}get keys(){return Array.from(this.__keys__)}create(t,e){return this.root=this._insert(t,e,this.root),this.__keys__.add(t),this}_insert(t,e,r){if(!r)return new A(t,e);t<r.key?r.left=this._insert(t,e,r.left):r.right=this._insert(t,e,r.right),r.height=1+Math.max(this._height(r.left),this._height(r.right));let i=this._getBalance(r);return i>1&&t<r.left.key?this._rotateRight(r):i<-1&&t>r.right.key?this._rotateLeft(r):i>1&&t>r.left.key?(r.left=this._rotateLeft(r.left),this._rotateRight(r)):i<-1&&t<r.right.key?(r.right=this._rotateRight(r.right),this._rotateLeft(r)):r}read(t){return this._find(t,this.root)}_find(t,e){return e?t===e.key?e.value:t<e.key?this._find(t,e.left):this._find(t,e.right):null}_height(t){return t?t.height:0}_getBalance(t){return t?this._height(t.left)-this._height(t.right):0}_rotateRight(t){let{left:e}=t,r=e.right;return e.right=t,t.left=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}_rotateLeft(t){let{right:e}=t,r=e.left;return e.left=t,t.right=r,t.height=1+Math.max(this._height(t.left),this._height(t.right)),e.height=1+Math.max(this._height(e.left),this._height(e.right)),e}update(t,e){let r=this.root;for(;r;){if(t===r.key)return r.value=e,!0;t<r.key?r=r.left:r=r.right}return!1}delete(t){this.root=this._delete(t,this.root)}_delete(t,e){if(!e)return null;if(t<e.key)e.left=this._delete(t,e.left);else if(t>e.key)e.right=this._delete(t,e.right);else{if(!e.left)return e.right;if(!e.right)return e.left;let i=this._findMinNode(e.right);e.key=i.key,e.value=i.value,e.right=this._delete(i.key,e.right)}e.height=1+Math.max(this._height(e.left),this._height(e.right));let r=this._getBalance(e);return r>1&&this._getBalance(e.left)>=0?this._rotateRight(e):r>1&&this._getBalance(e.left)<0?(e.left=this._rotateLeft(e.left),this._rotateRight(e)):r<-1&&this._getBalance(e.right)<=0?this._rotateLeft(e):r<-1&&this._getBalance(e.right)>0?(e.right=this._rotateRight(e.right),this._rotateLeft(e)):e}_findMinNode(t){return t.left?this._findMinNode(t.left):t}},b=new E;function nt(n,t){Object.defineProperty(n,t,{get:function(){return n.$____state____$[t]},set:function(e){n.$____update____$(r=>r[t]=e)}})}var C=class{constructor(t,e){let r=Object.keys(e),i=t.toLowerCase();this.$____namespace____$=i,this.$____dict____$=e,this.$____keys____$=r,b.create(i,e),r.forEach(a=>{nt(this,a)})}$redraw(){let{redraw:t}=window.$____XPRIVATEDICTX____$.router;t&&t()}get $update(){return this.$____update____$}get $store(){return b}get $____state____$(){return b.read(this.$____namespace____$)}$____update____$(t){let{data:e,update:r}=$.produce(this.$____dict____$,t);if(r){let i=this.$____namespace____$;this.$____dict____$=e,b.update(i,e);let a=new CustomEvent(rt,{detail:{namespace:i}});window.dispatchEvent(a)}}};function it(n,t){return new C(n,t)}var F=it;window.$____XPRIVATEDICTX____$={router:{},components:{},static:{},methods:{},vars:{},current:null};var g=window.$____XPRIVATEDICTX____$,st=w({props:{title:{type:String,default:"Oops!"}},view(){return["div",{style:"text-align: center"},[["h1",{style:"font-size: 8.5em"},[this.title]],["h3",{},"404 | Page not Found."]]]}});function O(n){return n="/"+n.replace(/^\/|\/$/g,"")+"/",n}function at(n){let t=new URLSearchParams(n),e={};return t.forEach((r,i)=>{e[i]=r}),e}function ot(n,t){let e=O(n),r=O(t),i=new RegExp(e.replace(/{(.*?)}/g,"([^/]+)")),a=r.match(i),c={};if(a){let s=e.match(/{(.*?)}/g);s&&s.forEach((o,h)=>{c[o.slice(1,-1)]=a[h+1]})}return c}function ct(n,t){let e=O(n),r=O(t);return new RegExp("^"+e.replace(/{(.*?)}/g,"([^/]+)")+"$").test(r)}function ht(n,t){let e=Object.keys(n).filter(r=>ct(r,t));return e.length>0?e[0]:"404"}function lt(n){let t=n||{},e=t.root?t.root:"#app",r=t.history?t.history:!1,i=t.routes?t.routes:{},a=t.components?t.components:[],c=t.methods?t.methods:{},s=t.static?t.static:{},o=t.vars?t.vars:{},h=null,u=null,l=null,p=null,y={},k={};r||window.location.hash||(window.location.hash="/");let U=f=>{let m=window.event;if(m)try{m.preventDefault&&m.preventDefault(),m.stopPropagation&&m.stopPropagation(),m.stopImmediatePropagation&&m.stopImmediatePropagation()}catch(K){}r?window.history.pushState({},"",f):window.location.hash=f,j()};async function j(){p=r?window.location.pathname:window.location.hash.slice(1),l=ht(i,p);let f=p.split("?");y=ot(l,f[0]),f.length>1&&(k=at(f[1])),u=i[l]||i[404]||st,h&&h.unmount(),u&&(h=u(),h.mount(e),g.current=h)}function G(){h.render()}window.onpopstate=j;let T={go:f=>U(f),redraw:()=>G()};return Object.defineProperty(T,"current",{get:function(){return Object.freeze({route:l,path:p,args:y,query:k})}}),g.components=M(a),g.router=T,g.methods=c,g.static=s,g.vars=o,Object.keys(o).forEach(f=>{g.vars[f]=F(f,o[f])}),j(),window.$____XPRIVATEDICTX____$}var W=lt;var At={h:w,app:W};export{At as default};
